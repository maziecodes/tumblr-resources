for(const e of document.querySelectorAll("p"))""===e.innerHTML.trim()&&e.remove();function updateTypes(e,t){t.classList.remove("text-post"),t.classList.add(`${e}-post`,"npf-post")}for(const e of posts){let t=e.npf,o=document.getElementById(`post-${e.id}`),n=o.querySelector(".caption:is(:not(:empty))");if(null!=n&&o.classList.contains("text-post")&&(t.trail.length||t.content.length)){switch(t.trail[0]?.content[0]?.type??t.content[0].type){case"image":updateTypes("photos",o),null==o.querySelector(".npf_row")&&n.prepend(o.querySelector("figure"));break;case"video":updateTypes("video",o);let e=o.querySelector("figure");n.prepend(e);break;case"link":updateTypes("link",o);case"audio":updateTypes("audio",o);break;case"quote":updateTypes("quote",o)}if(o.classList.contains("photos-post")){let e=document.createElement("div");e.classList.add("npf-photos"),n.prepend(e);let t=o.querySelector(".reblog-content p, .reblog-content h1, .reblog-content h2"),l=[];if(t){let e=t.parentNode.firstElementChild;for(;e!==t;)l.push(e),e=e.nextElementSibling}else l=o.querySelectorAll(".npf_row");for(const t of l)e.append(t);o.querySelectorAll(".npf_row").length>1?updateTypes("photoset",o):updateTypes("photo",o)}let e=o.querySelector(".reblog-header"),l=o.querySelector(".reblog-content");e?.nextElementSibling===l&&0===l?.childElementCount&&(e.remove(),l.remove())}}
